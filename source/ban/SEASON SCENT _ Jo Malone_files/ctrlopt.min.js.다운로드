var ctrlopt=ctrlopt||{};
(function(l,h){"function"!==typeof Object.create&&(Object.create=function(a,c){function b(){}b.prototype=a;var d=new b,e;for(e in c)!d[e]&&c.hasOwnProperty(e)&&(d[e]=c[e].value);return d});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),b=this,d=function(){},e=function(){return b.apply(this instanceof d?this:a,c.concat(Array.prototype.slice.call(arguments)))};
  d.prototype=this.prototype;e.prototype=new d;return e});ctrlopt.bind=function(a,c){if("function"!==typeof a)throw Error("CtrlOpt.bind requires the first argument to be a function");for(var b=[],d=2,e=arguments.length;d<e;d++)b.push(arguments[d]);return function(){if(0<arguments.length){b=[];for(var d=0,e=arguments.length;d<e;d++)b.push(arguments[d])}a.apply(c,b)}};ctrlopt.isDOMElement=function(a){try{a instanceof HTMLElement}catch(c){return ctrlopt.isDOMElement=function(a){return a&&"object"===typeof a&&
  a.nodeType&&1===a.nodeType&&"string"===typeof a.nodeName},ctrlopt.isDOMElement(a)}ctrlopt.isDOMElement=function(a){return a instanceof HTMLElement};return ctrlopt.isDOMElement(a)};ctrlopt.isDOMNode=function(a){try{a instanceof Node}catch(c){return ctrlopt.isDOMNode=function(a){return a&&"object"===typeof a&&"number"===typeof a.nodeType&&"string"===typeof a.nodeName},ctrlopt.isDOMNode(a)}ctrlopt.isDOMNode=function(a){return a instanceof Node};return ctrlopt.isDOMNode(a)};ctrlopt.Interface=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        c){if(2!==arguments.length)throw Error("Interface constructor expects exactly 2 arguments. It was called with "+arguments.length+" arguments");if("string"!==typeof a||c.constructor!==Array)throw new TypeError;this.name=a;this.methods=[];for(var b=0,d=c.length;b<d;b++){var e=c[b];if("string"!==typeof e)throw Error("Interface constructor expects method names to be passed in as strings. Method name number "+(b+1)+" is not a string");this.methods.push(e)}};ctrlopt.Interface=function(a,c){if(2!==arguments.length)throw Error("Interface constructor expects exactly 2 arguments. It was called with "+
  arguments.length+" arguments");if("string"!==typeof a||c.constructor!==Array)throw new TypeError;this.name=a;this.methods=[];for(var b=0,d=c.length;b<d;b++){var e=c[b];if("string"!==typeof e)throw Error("Interface constructor expects method names to be passed in as strings. Method name number "+(b+1)+" is not a string");this.methods.push(e)}};ctrlopt.Interface.ensureImplements=function(a,c){if(2>arguments.length)throw Error("Function ctrlopt.Interface.ensureImplements requires at least 2 arguments, but was called with "+
  arguments.length);for(var b=1,d=arguments.length;b<d;b++){var e,f=arguments[b];if(f.constructor!==ctrlopt.Interface)throw Error("Function Interface.ensureImplements expects arguments 2 and above to be instances of ctrlopt.Interface. Argument number "+(b+1)+"was not");e=f.methods;for(var g=0,k=e.length;g<k;g++){var h=e[g];if(!a[h]||"function"!==typeof a[h])throw Error("Function Interface.ensureImplements: object does not implement the "+f.name+" interface. The method "+h+" was not found.");}}};ctrlopt.extend=
  function(a,c){if("function"!==typeof a)throw new TypeError;var b="function"===typeof c,d=function(){};d.prototype=b?c.prototype:c;a.prototype=new d;a.prototype.constructor=a;a.superclass=b?c.prototype:c;b&&c.prototype.constructor===Object.prototype.constructor&&(c.prototype.constructor=c)};ctrlopt.getHrefParams=function(a){var c,b={};c=a.lastIndexOf("?");if(-1!==c&&c!==a.length-1){c=a.slice(c+1).split("&");for(var d=0,e=c.length;d<e;d++)a=c[d].split("="),b[a[0]]=a[1]}return b};ctrlopt.abstractMethod=
  function(){throw Error("Abstract Method has been called. Please call this method on a concrete implementation.");};ctrlopt.iPublisher=new ctrlopt.Interface("ctrlopt.iPublisher","on off fire has indexOf destroy".split(" "));ctrlopt.Publisher=function(){this.subscribers={}};ctrlopt.Publisher.prototype={on:function(a,c,b){"undefined"===typeof this.subscribers[a]&&(this.subscribers[a]=[]);this.has(a,c,b)||this.subscribers[a].push({func:c,context:b||this});return this},off:function(a,c,b){c=this.indexOf(a,
  c,b);-1<c&&this.subscribers[a].splice(c,1);return this},fire:function(a,c){var b;if(this.has(a)){b=this.subscribers[a].slice(0);for(var d=0,e=b.length;d<e;d++){var f=b[d];f.func.call(f.context,c)}}return this},has:function(a,c,b){if(!a)throw Error("A publisher's has method requires a type argument to check for");return"undefined"!==typeof this.subscribers[a]&&(1===arguments.length||-1<this.indexOf(a,c,b))?!0:!1},indexOf:function(a,c,b){b=b||this;if(a&&"undefined"!==typeof this.subscribers[a])for(var d=
  0,e=this.subscribers[a].length;d<e;d++){var f=this.subscribers[a][d];if(f.func===c&&f.context===b)return d}return-1},destroy:function(){this.subscribers=null;return this}};ctrlopt.mvc={};ctrlopt.mvc.iModel=new ctrlopt.Interface("iModel",["update","getData"]);ctrlopt.mvc.iView=new ctrlopt.Interface("iView","setModel getModel setController getController defaultController startObserving stopObserving isObserving onUpdate destroy".split(" "));ctrlopt.mvc.iController=new ctrlopt.Interface("iController",
  ["setModel","getModel","setView","getView","destroy"]);ctrlopt.mvc.AbstractView=function(){this.controller=this.model=void 0};ctrlopt.mvc.AbstractView.prototype={setModel:function(a){if(!a)throw new TypeError;"undefined"!==typeof this.model&&this.stopObserving();ctrlopt.Interface.ensureImplements(a,ctrlopt.mvc.iModel,ctrlopt.iPublisher);this.model=a;return this},getModel:function(){ctrlopt.Interface.ensureImplements(this.model,ctrlopt.mvc.iModel,ctrlopt.iPublisher);return this.model},setController:function(a){a&&
ctrlopt.Interface.ensureImplements(a,ctrlopt.mvc.iController);this.controller=a;return this},getController:function(){void 0===this.controller&&(this.controller=this.defaultController());this.controller&&ctrlopt.Interface.ensureImplements(this.controller,ctrlopt.mvc.iController);return this.controller},defaultController:ctrlopt.abstractMethod,startObserving:function(){if(this.model)return this.model.on("update",this.onUpdate,this),this},stopObserving:function(){if(this.model)return this.model.off("update",
  this.onUpdate,this),this},isObserving:function(){return this.model.has("update",this.onUpdate,this)},onUpdate:ctrlopt.abstractMethod,destroy:function(){this.stopObserving();this.model=void 0;this.controller&&this.controller.destroy();this.controller=void 0;return this}};ctrlopt.mvc.AbstractController=function(){this.view=this.model=void 0};ctrlopt.mvc.AbstractController.prototype={setModel:function(a){if(!a)throw new TypeError;"undefined"!==typeof this.model&&this.stopObserving();ctrlopt.Interface.ensureImplements(a,
  ctrlopt.mvc.iModel,ctrlopt.iPublisher);this.model=a;return this},getModel:function(){ctrlopt.Interface.ensureImplements(this.model,ctrlopt.mvc.iModel,ctrlopt.iPublisher);return this.model},setView:function(a){if(!a)throw new TypeError;ctrlopt.Interface.ensureImplements(a,ctrlopt.mvc.iView);this.view=a;return this},getView:function(){return this.view},startObserving:function(){if(this.model)return this.model.on("update",this.onUpdate,this),this},stopObserving:function(){if(this.model)return this.model.off("update",
  this.onUpdate,this),this},isObserving:function(){return this.model.has("update",this.onUpdate,this)},onUpdate:ctrlopt.abstractMethod,destroy:function(){this.view=this.model=void 0;return this}};ctrlopt.ImgPreloader=function(a){ctrlopt.ImgPreloader.superclass.constructor.call(this);var c=a.elementId||"img-preloader";a=a.elementClass;var b=h.getElementById(c);this.LOADED="loaded";this.ERROR="error";b?a&&(b.className+=" "+a):(b=h.createElement("div"),b.id=c,a&&(b.className=a),h.body.appendChild(b));
  this.element=b};ctrlopt.extend(ctrlopt.ImgPreloader,ctrlopt.Publisher);ctrlopt.ImgPreloader.prototype.load=function(a){function c(b){d++;d>=a.length&&e.fire(e.LOADED)}function b(a){console.log("ctrlopt.ImgPreloader Error: "+a);e.fire(e.ERROR,a)}if(!a)throw new TypeError;var d=0,e=this;a=a instanceof Array?a:[a];for(var f=a.length;0<=--f;){var g=new Image;g.onload=c;g.onerror=b;g.src=a[f];this.element.appendChild(g)}};ctrlopt.ImgPreloader.prototype.clear=function(){this.element.innerHTML=""}})(window,
  document);