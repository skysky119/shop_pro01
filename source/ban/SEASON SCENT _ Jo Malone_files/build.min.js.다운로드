var generic=generic||{};var site=site||{};generic.endeca=generic.endeca||{catalog:{},result:{},results:{},resultsgroup:{},mixins:{},instances:{},generic:{Class:generic.Class||{},env:generic.env||{},rb:generic.rb||{},template:generic.template||{}},helpers:{array:{toInt:function(b){for(var a=0;a<b.length;a++){b[a]=parseInt(b[a])}return b},unique:function(e){var d={},b=[];for(var c=0;c<e.length;c++){if(typeof d[e[c]]=="undefined"){b.push(e[c])}d[e[c]]=1}return b},remove:function(c,b){var a;var b=jQuery.isArray(b)?b:[b];return jQuery.grep(c,function(d){return jQuery.inArray(d,b)==-1})}},func:{bind:function(){var b=arguments[0]||null;var c=arguments[1]||this;var a=jQuery.grep(arguments,function(d,e){return e>1});return function(){return b.apply(c,a)}}},string:{toQueryParams:function(a,f){var a=a||"";var f=f||"&";var e=a.substring(a.indexOf("?")+1).split("#")[0].split(f||"&"),h={},c,b,d,g;for(c=0;c<e.length;c++){g=e[c].split("=");b=decodeURIComponent(g[0]);d=(g[1])?decodeURIComponent(g[1]):"";if(h[b]){if(typeof h[b]=="string"){h[b]=[h[b]]}h[b].push(d)}else{h[b]=d}}return h}},obj:{first:function(b){for(var a in b){return b[a]}},slice:function(c,d){var b={};for(var a=0;a<d.length;a++){if(typeof c[d[a]]!="undefined"){b[d[a]]=c[d[a]]}}return b}}}};site.endeca=generic.endeca;generic.endeca.catalog=site.endeca.generic.Class.create({initialize:function(a){this.jsonResult=null;this.resultList=[];jQuery.extend(this,a||{});if(this.jsonResult){this.parseData()}},parseData:function(){if(this.jsonResult.AggrRecords){for(var b=0;b<this.jsonResult.AggrRecords.length;b++){for(var a=0;a<this.jsonResult.AggrRecords[b].Records.length;a++){this._parseRecord(this.jsonResult.AggrRecords[b].Records[a])}}}else{if(this.jsonResult.Records){for(var b=0;b<this.jsonResult.Records.length;b++){this._parseRecord(this.jsonResult.Records[b])}}}}});site.endeca.catalog=generic.endeca.catalog;generic.endeca.catalog.content=site.endeca.generic.Class.create(site.endeca.catalog,{_parseRecord:function(a){this.resultList.push({Properties:{image:site.endeca.generic.rb("endeca").get("content.image_url"),title:a.Properties.p_PROD_RGN_NAME,description:a.Properties.p_DESCRIPTION,link:a.Properties.p_url,link_text:site.endeca.generic.rb("endeca").get("content.link_text"),Zone:"crawlData"}})}});site.endeca.catalog.content=generic.endeca.catalog.content;generic.endeca.catalog.product=site.endeca.generic.Class.create(site.endeca.catalog,{initialize:function(a){this.categoryList={};this.productList={};this.skuList={};this.parseOrderHi=0;this.parseOrderLo=0;this._super(a);this.resultList=this.getProducts()},_parseRecord:function(a){if(a.Properties.rec_type=="product"){var b={c:{},p:{},s:{}};b.p["matched"]=1;b.s["matched"]=0;for(var e in a.Properties){var d=a.Properties[e];if(d&&d!=""&&!isNaN(d)){if(d.match(/\./)){d=parseFloat(d)}else{d=parseInt(d)}}if(e.match(/_json/i)){e=e.replace(/_json/i,"");d=jQuery.parseJSON(d)}if(e.match(/^([a-z])_/)){b[RegExp.$1]=b[RegExp.$1]?b[RegExp.$1]:[];b[RegExp.$1][e.substr(2)]=d}if(e=="DGraph.WhyDidItMatch"){b.s["matchedOn"]=d;var c=typeof d=="object"?d.join():d;if(c.match(/s_/)){b.p["matched"]=0;b.s["matched"]=1}}}this.addProps(b.c,b.p,b.s)}},addProps:function(a,c,h,i){var f=a.CATEGORY_ID;var e=c.PRODUCT_ID;var g=h.SKU_ID;if(!f||!e||!g){return}var j=this.skuList[g]||{};this.skuList[g]=jQuery.extend(j,h);var d=this.productList[e]||{parseOrder:++this.parseOrderHi};if(i&&d.parseOrder>0){d.parseOrder=--this.parseOrderLo}d=jQuery.extend(d,c);if(!d.skus){d.skus=[]}if(!d.skuList){d.skuList={}}if(!d.skuList[g]){d.skus.push(j)}d.skuList[g]=j;this.productList[e]=d;j.product=d;var b=this.categoryList[f]||{};b=jQuery.extend(b,a);if(!b.prods){b.prods=[]}b.prods.push(d);this.categoryList[f]=b},getProducts:function(){function d(f,e){if(f.parseOrder>e.parseOrder){return 1}else{if(f.parseOrder<e.parseOrder){return -1}}return 0}function b(f,e){if(f.DISPLAY_ORDER>e.DISPLAY_ORDER){return 1}else{if(f.DISPLAY_ORDER<e.DISPLAY_ORDER){return -1}}return 0}var a=[];for(var c in this.productList){this.productList[c].skus.sort(b);a.push(this.productList[c])}a.sort(d);return a},getSkus:function(){var a=[];for(var b in this.skuList){a.push(this.skuList[b])}return a},getCategory:function(a){var b=(this.categoryList?this.categoryList[a]:null);return b},getProduct:function(b){var a=(this.productList?this.productList[b]:null);return a},getSku:function(b){var a=(this.skuList?this.skuList[b]:null);return a}});site.endeca.catalog.product=generic.endeca.catalog.product;generic.endeca.control=site.endeca.generic.Class.create({initialize:function(a){this.configuration=a||site.endeca.configuration;this.queryString=site.endeca.generic.env.query("qs")||"";this.searchTerm=site.endeca.generic.env.query("search")||"";this.hasResults=false;this.hasSearched=0;this.wildcardSearch=false;this.customClasses={};this.results={};this.queries={};this.catalogs={};this.nodes={};if(this.configuration.mustacheMappings){this.loadMustacheMappings()}if(this.configuration.queries){this.generateQueries()}if(this.configuration.results){this.generateResults()}if(this.configuration.nodes){this.generateNodes()}if(this.configuration.coremetricsEnabled){site.endeca.coremetrics.initialize({enabled:true})}if(this.configuration.omnitureEnabled){if(site.endeca.omniture){site.endeca.omniture.initialize({enabled:true})}}if(this.hasAnalyticsIntegrated()&&!this.isTypeahead()){if(site&&site.track){site.track.disableDefaultPageView()}}},loadMustacheMappings:function(){if(this.configuration.mustacheMappings){site.endeca.generic.template.loadMustacheMappings({mappings:this.configuration.mustacheMappings})}},generateQueries:function(){for(var a in this.configuration.queries){this.queries[a]=new site.endeca.query(jQuery.extend({callbackCompleted:site.endeca.helpers.func.bind(this.searchCompleted,this)},this.configuration.query,this.configuration.queries[a]||{}))}},generateResults:function(){for(var resultsName in this.configuration.results){this.configuration.results[resultsName].childClass=this.configuration.results[resultsName].childClass||"";var mixins=this.configuration.mixins[this.configuration.results[resultsName].mixinKey]||this.configuration.mixins[this.configuration.results[resultsName].childClass.replace(/site\.endeca\./,"")]||this.configuration.mixins[this.configuration.results[resultsName].baseClass.replace(/site\.endeca\./,"")+"."+resultsName]||this.configuration.mixins[this.configuration.results[resultsName].baseClass.replace(/site\.endeca\./,"")];var baseClass=eval(this.configuration.results[resultsName].baseClass);var childClass=eval(this.configuration.results[resultsName].childClass)||baseClass[resultsName]||{};this.customClasses[resultsName]=site.endeca.generic.Class.create(site.endeca.generic.Class.mixin(baseClass,mixins),childClass);this.results[resultsName]=new this.customClasses[resultsName](jQuery.extend({},{mixins:this.configuration.mixins,configuration:this.configuration.results[resultsName].configuration||{}},this.configuration.results[resultsName].instanceArgs||{}))}},generateNodes:function(){for(var a in this.configuration.nodes){this.nodes[a]=this.configuration.nodes[a]}},search:function(b){var b=b||{searchTerm:null,queryString:null};this.hasSearched++;this.showLoading();this.resetQueries();var d=b.queryString||this.queryString||"";var a=d?site.endeca.helpers.string.toQueryParams(d)["Ntt"]:(b.searchTerm||this.searchTerm||"");for(var c in this.queries){this.queries[c].searchTerm=a;this.queries[c].queryString=this.queries[c].noQueryString?"":d;this.queries[c].prepare();this.queries[c].execute();this.searchTerm=this.queries[c].searchTerm}},searchCompleted:function(a){if(this.queriesCompleted()){this.resetResults();for(var c in this.queries){this.catalogs[c]=new site.endeca.catalog[c]({jsonResult:this.queries[c].jsonResult})}this.meta=new site.endeca.meta({query:this.queries.product,jsonResult:this.queries.product.jsonResult,searchKey:this.queries.product.searchKey,configuration:{followRedirects:this.configuration.followRedirects,contentzones:this.configuration.contentzones}});if(this.meta.redirecting){if(this.hasAnalyticsIntegrated()&&site&&site.elcEvents){site.elcEvents.dispatch("track:searchRedirect",this)}return false}this.hideLoading();if(this.hasAnalyticsIntegrated()&&!this.wildcardSearch&&site&&site.elcEvents){var b=this;if(this.isTypeahead()){site.elcEvents.addListener("track:ready",function(){site.elcEvents.dispatch("track:searchTypeaheadLoaded",b)})}else{site.elcEvents.addListener("track:ready",function(){site.elcEvents.dispatch("track:searchPageLoaded",b)})}}return true}return false},queriesCompleted:function(){for(var a in this.queries){if(!this.queries[a].completed){return false}}return true},processCoremetrics:function(b){var b=b||{pageView:true};if(this.configuration.coremetricsEnabled){site.endeca.coremetrics.reset();site.endeca.coremetrics.pageView=b.pageView;site.endeca.coremetrics.productCount=this.meta.searchInfo.totalProductRecords;site.endeca.coremetrics.contentCount=this.meta.searchInfo.totalContentRecords;site.endeca.coremetrics.searchTerm=this.meta.searchInfo.correctedTerms&&this.meta.searchInfo.correctedTerms.length?this.meta.searchInfo.correctedTerms[0]:this.queries.product.parsedSearchTerm();site.endeca.coremetrics.wildcardSearch=this.wildcardSearch;site.endeca.coremetrics.numberOfPages=this.meta.pagination?this.meta.pagination.numberOfPages:1;site.endeca.coremetrics.currentPage=this.meta.pagination?this.meta.pagination.numberOfCurrentPage:1;if(this.meta.dimensions.breadcrumbs){for(var c=0;c<this.meta.dimensions.breadcrumbs.length;c++){for(var a=0;a<this.meta.dimensions.breadcrumbs[c]["Dimension Values"].length;a++){site.endeca.coremetrics.addRefinement({dimensionName:this.meta.dimensions.breadcrumbs[c]["Dimension Name"],refinement:this.meta.dimensions.breadcrumbs[c]["Dimension Values"][a]["Dim Value Name"]})}}}site.endeca.coremetrics.setPageView()}},processOmniture:function(){if(this.configuration.omnitureEnabled){site.endeca.omniture.reset();site.endeca.omniture.productCount=this.meta.searchInfo.totalProductRecords;site.endeca.omniture.contentCount=this.meta.searchInfo.totalContentRecords;site.endeca.omniture.searchTerm=this.meta.searchInfo.correctedTerms&&this.meta.searchInfo.correctedTerms.length?this.meta.searchInfo.correctedTerms[0]:this.queries.product.parsedSearchTerm();site.endeca.omniture.numberOfPages=this.meta.pagination?this.meta.pagination.numberOfPages:1;site.endeca.omniture.currentPage=this.meta.pagination?this.meta.pagination.numberOfCurrentPage:1;var b=this.configuration.searchType||this.queries.product.searchKey;if(b){site.endeca.omniture.searchType=b}if(b=="all"){if(this.meta.dimensions.breadcrumbs){var c=this.meta.dimensions.breadcrumbs[this.meta.dimensions.breadcrumbs.length-1];var a=c["Dimension Values"][c["Dimension Values"].length-1];site.endeca.omniture.refineSearch(a["Dim Value Name"])}else{site.endeca.omniture.searchResults()}}}},isTypeahead:function(){if(this.configuration.minSearchLength){return 1}else{return 0}},hasAnalyticsIntegrated:function(){if(Drupal&&Drupal.settings&&Drupal.settings.analytics){return Drupal.settings.analytics.analytics_integrated}else{return 0}},showLoading:function(){if(this.nodes.loading){this.nodes.loading.show()}},hideLoading:function(){if(this.nodes.loading){this.nodes.loading.hide()}},displayResults:function(){if(this.hasResults){if(this.results.bestsellers){this.results.bestsellers.hide()}if(this.results.content){this.results.content.show()}if(this.nodes.resultsContainer){this.nodes.resultsContainer.show()}if(this.nodes.noResultsContainer){this.nodes.noResultsContainer.hide()}this.processCoremetrics();this.processOmniture();this.wildcardSearch=false;return true}else{if(this.wildcardSearch){if(this.nodes.resultsContainer){this.nodes.resultsContainer.hide()}if(this.nodes.noResultsContainer){this.nodes.noResultsContainer.show()}if(this.results.content){if(this.configuration.noResultsContentZone){this.results.content.contentzones=this.configuration.noResultsContentZone;this.results.content.resultData=this.meta.supplementalContent;this.results.content.displayResults();this.results.content.show()}else{this.results.content.hide()}}if(this.results.bestsellers){this.results.bestsellers.displayResults();this.results.bestsellers.show()}this.processCoremetrics();this.processOmniture();this.wildcardSearch=false;return true}else{this.wildcardSearch=true;this.search({searchTerm:this.searchTerm+"*"});return false}}},resetQueries:function(){for(var a in this.queries){this.queries[a].reset()}},resetResults:function(){this.hasResults=false;for(var a in this.results){this.results[a].reset()}}});site.endeca.control=generic.endeca.control;generic.endeca.coremetrics={enabled:false,category_id:"search",page_id:"Search Results",productCount:0,contentCount:0,searchTerm:null,refinementsList:[],numberOfPages:1,currentPage:1,pageView:true,dimensionNameMap:{"Skin Type":"Typ","Skin Tone":"Ton"},wildcardSearch:false,initialize:function(a){jQuery.extend(this,a)},addRefinement:function(c){var c=c||{};if(c.dimensionName&&c.refinement){var a;if(this.dimensionNameMap[c.dimensionName]){a=this.dimensionNameMap[c.dimensionName]}else{var b=c.dimensionName.split(" ");a=b.shift().substr(0,3);for(var d=0;d<b.length;d++){a+=b[d].charAt(0)}}this.refinementsList.push(a+":"+c.refinement)}},setPageView:function(){if(this.pageView){var b=this.page_id+" "+this.currentPage;var d=this.category_id;var a=this.searchTerm;var e=this.contentCount+this.productCount;var c=this.refinementsList.join(" > ");if(c){b="Search Results Filtered "+this.currentPage}if(this.contentCount>0&&this.productCount==0){a="*"+a}if(typeof cmCreatePageviewTag=="function"){cmCreatePageviewTag(b,a,d,e.toString(),c)}if(this.wildcardSearch){if(typeof cmCreateConversionEventTag=="function"){cmCreateConversionEventTag("RESULTS PAGE",1,"ENDECA WILDCARD SEARCH",1)}}else{if(typeof cmCreateConversionEventTag=="function"){cmCreateConversionEventTag("RESULTS PAGE",1,"NO ENDECA WILDCARD SEARCH",1)}}}},contentClick:function(){if(typeof cmCreatePageElementTag=="function"){cmCreatePageElementTag("CONTENT","SEARCH DROPDOWN")}},productClick:function(){cmCreatePageElementTag("PRODUCTS","SEARCH DROPDOWN");if(this.wildcardSearch){if(typeof cmCreateConversionEventTag=="function"){cmCreateConversionEventTag("SEARCH DROPDOWN",1,"ENDECA WILDCARD SEARCH",1)}}else{if(typeof cmCreateConversionEventTag=="function"){cmCreateConversionEventTag("SEARCH DROPDOWN",1,"NO ENDECA WILDCARD SEARCH",1)}}},seeAllClick:function(){if(typeof cmCreatePageElementTag=="function"){cmCreatePageElementTag("SEE ALL","SEARCH DROPDOWN")}},reset:function(){this.refinementsList=[];this.pageView=true}};site.endeca.coremetrics=generic.endeca.coremetrics;site.endeca.omniture={enabled:false,page_id:"Search Results",productCount:0,contentCount:0,searchTerm:null,searchType:"Regular",refinementsList:[],numberOfPages:1,currentPage:1,initialize:function(a){jQuery.extend(this,a)},searchResults:function(){var b=this.page_id+" "+this.currentPage;var a=this.searchTerm;var c=this.searchType;var d=this.contentCount+this.productCount;if(this.contentCount>0&&this.productCount==0){a="*"+a}omnidata=[a,this.contentCount,this.productCount,b,c];if(typeof tms_page_data.tms_page_info!="undefined"){tms_page_data.tms_page_info.SEARCH=omnidata}else{tms_page_data.SEARCH=omnidata}jQuery(window).trigger("OMNISEARCH",[omnidata])},refineSearch:function(a){omnidata=[a,this.productCount];if(typeof tms_page_data.tms_page_info!="undefined"){tms_page_data.tms_page_info.FILTERSEARCH=omnidata}else{tms_page_data.FILTERSEARCH=omnidata}jQuery(window).trigger("FILTERSEARCH",[omnidata])},contentClick:function(){},productClick:function(){var b=this.page_id+" "+this.currentPage;var a=this.searchTerm;var c=this.searchType;var d=this.contentCount+this.productCount;if(this.contentCount>0&&this.productCount==0){a="*"+a}omnidata=[a,this.contentCount,this.productCount,b,c];if(typeof tms_page_data.tms_page_info!="undefined"){tms_page_data.tms_page_info.TYPEAHEAD=omnidata}else{tms_page_data.TYPEAHEAD=omnidata}jQuery(window).trigger("OMNISEARCH",[omnidata])},seeAllClick:function(){jQuery(window).trigger("SEARCHALLCLK")},reset:function(){this.refinementsList=[]}};generic.endeca.meta=site.endeca.generic.Class.create({initialize:function(a){this.jsonResult=null;this.searchKey="all";this.hasRedirects=false;this.redirecting=false;this.pagination=null;this.sorting=[];this.dimensions={};this.metaInfo={};this.searchInfo={};this.supplementalObjects=[];this.supplementalContent={};jQuery.extend(this,a);if(this.jsonResult){this.parseData()}},parseData:function(a){this.processMetaInfo();this.processSearchInfo();this.processSupplemental();this.processPagination();this.processSorting();this.processDimensions()},processMetaInfo:function(){this.metaInfo=this.jsonResult.MetaInfo||this.metaInfo;this.numberOfPages=this.getMetaProp("Number of Pages",1);this.recordsReturned=this.getMetaProp("Number of Records Returned",0);this.recordsPerPage=this.getMetaProp("Number of Records per Page",0);this.totalMatchRecords=this.getMetaProp("Total Number of Matching Records",0);this.totalAggrRecords=this.getMetaProp("Total Number of Matching Aggregate Records",0)},processSearchInfo:function(a){var a=a||{totalContentRecords:0};var c=this.jsonResult&&this.jsonResult["Search Info"]&&this.jsonResult["Search Info"][this.searchKey]?this.jsonResult["Search Info"][this.searchKey]:{};this.searchInfo.searchTerm=c["Search Term"]||"";if(this.searchInfo.searchTerm.match(/\*$/)){this.searchInfo.searchTerm=this.searchInfo.searchTerm.slice(0,-1)}this.searchInfo.totalContentRecords=a.totalContentRecords||0;this.searchInfo.totalProductRecords=this.totalAggrRecords||this.totalMatchRecords;this.searchInfo.contentResultText=this.searchInfo.totalContentRecords==1?site.endeca.generic.rb("endeca").get("content_result"):site.endeca.generic.rb("endeca").get("content_results");this.searchInfo.productResultText=this.searchInfo.totalProductRecords==1?site.endeca.generic.rb("endeca").get("product"):site.endeca.generic.rb("endeca").get("products");this.searchInfo.totalRecords=parseInt(this.searchInfo.totalContentRecords)+parseInt(this.searchInfo.totalProductRecords);this.searchInfo.resultText=this.searchInfo.totalRecords==1?site.endeca.generic.rb("endeca").get("result"):site.endeca.generic.rb("endeca").get("results");this.searchInfo.startingRecord=this.searchInfo.totalProductRecords?this.getMetaProp("Starting Record Number",1):0;this.searchInfo.endingRecord=this.getMetaProp("Ending Record Number",1);this.searchInfo.originalRecords=this.searchInfo.totalRecords;this.searchInfo.originalResultText=this.searchInfo.resultText;this.searchInfo.correctedTerms=[];if(c["Spell Correction"]){for(var b=0;b<c["Spell Correction"].length;b++){if(c["Spell Correction"][b]["New Term"].toLowerCase().indexOf(this.searchInfo.searchTerm.toLowerCase())<0&&c["Spell Correction"][b]["AutoPhrasing"]=="false"){this.searchInfo.correctedTerms.push(c["Spell Correction"][b]["New Term"])}}}if(this.searchInfo.correctedTerms.length){this.searchInfo.originalRecords=0;this.searchInfo.originalResultText=this.searchInfo.originalRecords==1?site.endeca.generic.rb("endeca").get("result"):site.endeca.generic.rb("endeca").get("results")}this.searchInfo.didYouMean=[];if(c["DYM Information"]){for(var b=0;b<c["DYM Information"].length;b++){if(c["DYM Information"][b]["New Term"].toLowerCase().indexOf(this.searchInfo.searchTerm.toLowerCase())<0&&c["DYM Information"][b]["AutoPhrasing"]=="false"){this.searchInfo.didYouMean.push({"Selection Link":c["DYM Information"][b]["Pivot Link"],Term:c["DYM Information"][b]["New Term"]})}}}},processPagination:function(){if(this.numberOfPages>1){var a=new site.endeca.query(jQuery.extend(true,{},site.endeca.configuration.query,{recordsPerPage:10000}));this.pagination={numberOfPages:this.numberOfPages,numberOfCurrentPage:this.getMetaProp("Page Number",1),viewAllLink:this.query.getMergedQueryString(a.toQueryString()),previousPageLink:this.getMetaProp("Previous Page Link"),nextPageLink:this.getMetaProp("Next Page Link"),directPageLinks:this.getMetaProp("Direct Page Links","")}}},processSorting:function(){var b=this.getMetaProp("Add Sort Key Links",[]);var a=this.getMetaProp("Sorted By",[]);if(b.length){this.sorting=this.sorting.concat(b)}if(a.length){this.sorting=this.sorting.concat(a)}},processDimensions:function(){var a=[];var f=[];if(this.jsonResult.Breadcrumbs){for(var c=0;c<this.jsonResult.Breadcrumbs.length;c++){var e=this.jsonResult.Breadcrumbs[c];if(e&&e.Type=="Navigation"){for(var b=0;b<e["Dimension Values"].length;b++){e["Dimension Values"][b]["Removal Link"]=this.query.getMergedQueryString(e["Dimension Values"][b]["Removal Link"],parseInt(e["Dimension Values"][b]["Dim Value ID"]))}a.push(e)}}}if(this.jsonResult.Refinements){for(var c=0;c<this.jsonResult.Refinements.length;c++){var d=this.jsonResult.Refinements[c];if(d&&d.Dimensions&&d.Dimensions[0]&&d.Dimensions[0]["Dimension Values"]){for(var b=0;b<d.Dimensions[0]["Dimension Values"].length;b++){d.Dimensions[0]["Dimension Values"][b]["Selection Link"]=this.query.getMergedQueryString(d.Dimensions[0]["Dimension Values"][b]["Selection Link"])}f.push(d.Dimensions[0])}}}if(a.length){this.dimensions.breadcrumbs=a}if(f.length){this.dimensions.refinements=f}},processSupplemental:function(){this.supplementalObjects=this.jsonResult["Supplemental Objects"]||this.supplementalObjects;for(var c=0;c<this.supplementalObjects.length;c++){var a=this.supplementalObjects[c];if(a.Properties){if(a.Properties["DGraph.KeywordRedirectUrl"]){this.hasRedirects=true;if(this.configuration.followRedirects){this.redirecting=true;document.location.href=a.Properties["DGraph.KeywordRedirectUrl"]}return false}if(a.Properties["DGraph.SeeAlsoMerchId"]){var b=a.Properties.Zone;var d=this.supplementalContent[b]||{records:[]};d.style=a.Properties.Style;a=this.highlightSearchTermInSupplemental(a);if(!a.Properties["suppress_"+(jQuery.cookie("LOCALE")||"en_US")]){d.records.push(a)}this.supplementalContent[b]=d}}}},highlightSearchTermInSupplemental:function(a){return a},getMetaProp:function(b,a){var c=(this.metaInfo[b]||a);if(!isNaN(c)){c=parseInt(c)}return c}});site.endeca.meta=generic.endeca.meta;var Drupal=Drupal||{};Drupal.settings=Drupal.settings||{};Drupal.settings.endeca=Drupal.settings.endeca||{};generic.endeca.query=site.endeca.generic.Class.create({initialize:function(a){this.configuration=a||{};this.sessionId=Math.floor(Math.random()*999999)+1;this.url="/enrpc/JSONControllerServlet.do";this.urlParams={};this.queryString=null;this.searchTerm="";this.searchKey="all";this.searchMode="matchallpartial";this.searchDimensions=true;this.computePhrasings=true;this.didYouMean=true;this.recordsPerPage=10;this.pageNumber=1;this.sortKey=null;this.rollup=true;this.rollupId="p_PRODUCT_ID";this.rollupDetail=true;this.configuredRangeFilters={};this.defaultRangeFilters=[];this.rangeFilters=[];this.additionalRangeFilters=[];this.configuredRecordFilters={};this.defaultRecordFilters=[];this.recordFilters=[];this.additionalRecordFilters=[];this.recordId=null;this.configureLocale({props:["MDEXHost","MDEXPort","logHost","logPort","defaultDimensionIds"],locale:jQuery.cookie("LOCALE")||"en_US"});jQuery.extend(this,this.configuration);this.recordFilters.push("locale");this.completed=0;this.exportUrlParams=["N","Ne","Nao","Ntt","D","M"];this.setupServer()},reset:function(){this.urlParams={};this.queryString=null;this.jsonResult=null;this.completed=0},prepare:function(){this.setupServer();if(this.recordId){this.setupRecordId()}else{if(this.searchTerm){this.searchTerm=jQuery.trim(this.parsedSearchTerm());if(this.computePhrasings){this.setupPhraseComputation()}if(this.didYouMean){this.setupDidYouMean()}if(this.searchDimensions){this.setupDimensionSearch()}this.setupSearch()}}if(this.pageNumber){this.setupPage()}if(this.sortKey){this.setupSort()}if(this.rollup){this.setupRollUp()}this.setupNavigation();this.setupRangeFilters();this.setupRecordFilters();if(this.queryString){this.queryString=decodeURIComponent(this.queryString);this.processQueryString()}else{this.setupDimensionIds()}},execute:function(){var a=this.url+"?"+this.toQueryString();jQuery.ajax({url:a,type:"get",context:this,complete:this.onComplete})},onComplete:function(a){this.completed=1;this.rawResult=a.responseText;this.jsonResult=jQuery.parseJSON(this.rawResult);this.callbackCompleted()},toQueryString:function(a){var a=a||{};var b=a.urlParams?jQuery.param(a.urlParams):jQuery.param(this.urlParams);b=b.replace(/%2B/gi,"+");return b},processQueryString:function(){this.urlParams=jQuery.extend(true,this.urlParams,site.endeca.helpers.string.toQueryParams(this.queryString));this.searchTerm=this.urlParams.Ntt||"";this.setupDimensionIds();this.setupRangeFilters();this.setupRecordFilters()},getMergedQueryString:function(e,b){var c=site.endeca.helpers.string.toQueryParams(e);if(!c.Nao){c.Nao=0}var a=jQuery.extend(true,{},this.urlParams,c);var d=this._getDimensionIds({urlParams:c,oldDimensionIds:this.urlParams.Ne});d=site.endeca.helpers.array.remove(d,this.defaultDimensionIds);d=b?site.endeca.helpers.array.remove(d,b):d;a.Ne=d.join("+");return this.toQueryString({urlParams:site.endeca.helpers.obj.slice(a,this.exportUrlParams)})},setupServer:function(){this.urlParams.M="host:"+this.MDEXHost+"|port:"+this.MDEXPort+"|recs_per_page:"+this.recordsPerPage;this.urlParams.L="host:"+this.logHost+"|port:"+this.logPort},setupRecordId:function(){this.urlParams.R=this.recordId},setupNavigation:function(){this.urlParams.N=this.defaultNavigation?this.defaultNavigation.join("+"):""},setupDimensionIds:function(){var a=this._getDimensionIds({urlParams:this.urlParams});if(a.length){this.urlParams.Ne=a.join("+")}},setupSearch:function(a){var a=a||{};this.urlParams.Ntt=(a.searchTerm||this.searchTerm).toLowerCase();this.urlParams.Ntk=this.searchKey;this.urlParams.Ntx=this.searchMode.match(/mode\+/)?this.searchMode:("mode+"+this.searchMode)},setupDimensionSearch:function(a){var a=a||{};this.urlParams.D=(a.searchTerm||this.searchTerm).toLowerCase();this.urlParams.Dx=this.searchMode.match(/mode\+/)?this.searchMode:("mode+"+this.searchMode)},setupPhraseComputation:function(){this.urlParams.Ntpc=1;this.urlParams.Ntpr=1},setupDidYouMean:function(){this.urlParams.Nty=1},setupSort:function(){this.urlParams.Ns=this.sortKey},setupRollUp:function(){this.urlParams.Nu=this.rollupId;this.urlParams.Np=this.rollupDetail?2:1},setupPage:function(){this.urlParams.Nao=(this.pageNumber-1)*this.recordsPerPage},setupRangeFilters:function(){var a=this._getFilters(this.defaultRangeFilters,this.rangeFilters,this.additionalRangeFilters,this.configuredRangeFilters);if(a.length){this.urlParams.Nf=a.join("|")}},setupRecordFilters:function(){var a=this._getFilters(this.defaultRecordFilters,this.recordFilters,this.additionalRecordFilters,this.configuredRecordFilters);if(a.length){this.urlParams.Nr="AND("+a.join(",")+")"}},_getFilters:function(b,d,e,c){var a=[];jQuery.each(d,function(f,g){a.push(c[g])});jQuery.each(b,function(f,g){a.push(c[g])});jQuery.each(e,function(f,g){a.push(g)});return a},_getDimensionIds:function(a){var b=[];if(a.oldDimensionIds){b=b.concat(a.oldDimensionIds.split("+"))}if(a.addDefaultDimensionIds){b=b.concat((a.oldDimensionIds).split("+"))}b=b.concat(a.urlParams&&a.urlParams.Ne?(a.urlParams.Ne).split("+"):[]);b=b.concat(this.defaultDimensionIds);b=site.endeca.helpers.array.toInt(b);b=site.endeca.helpers.array.unique(b);return b},parsedSearchTerm:function(b){var b=b||{};var a=b.searchTerm||this.searchTerm;var c;try{c=decodeURIComponent(a)}catch(d){c=a}c=c.replace(/\+/g," ");return c.match(/[<>\/]/)==null?c:""},configureLocale:function(a){var a=a||{props:[],locale:""};for(var b=0;b<a.props.length;b++){if(typeof this.configuration[a.props[b]]=="object"&&typeof this.configuration[a.props[b]][a.locale]!="undefined"){this.configuration[a.props[b]]=this.configuration[a.props[b]][a.locale]}}}});site.endeca.query=generic.endeca.query;generic.endeca.result=site.endeca.generic.Class.create({initialize:function(a){this.parentNode=null;this.node=null;this.resultData=null;this.templatePath=null;jQuery.extend(this,a||{})},displayResult:function(b){var b=b||{};var a=b.parentNode||this.parentNode;var c=this;site.endeca.generic.template.get({path:c.templatePath,object:b.resultData||c.resultData,rb:rb?rb.endeca:null,callback:function(d){d=jQuery.trim(d);if(d){c.node=jQuery(d);if(a&&c.node){a.append(c.node)}c.displayResultCallback(b)}}})},displayResultCallback:function(a){},reset:function(){if(this.node&&this.parentNode&&this.node!=this.parentNode){this.node.remove()}else{this.parentNode.empty()}},hide:function(){this.parentNode.hide()},show:function(){this.parentNode.show()}});site.endeca.result=generic.endeca.result;generic.endeca.results=site.endeca.generic.Class.create({initialize:function(a){this.parentNode=null;this.node=null;this.headerNode=null;this.contentNode=null;this.resultData=[];this.resultNodes=[];this.resultClass=null;this.configuration={};this.mixins={};jQuery.extend(this,a)},setupNodes:function(b){var b=b||{};var a=b.parentNode||this.parentNode;var c=b.containerTemplatePath||this.containerTemplatePath;this.node=a||b.node;if(this.node){if(c){this.loadContainer({parentNode:a,containerTemplatePath:c})}this.headerNode=this.node.find(".results-header:first").length?this.node.find(".results-header:first"):null;this.contentNode=this.node.find(".results:first").length?this.node.find(".results:first"):this.node}},displayResults:function(b){var b=b||{};b.childClass=b.childClass||this.childClass;this.setupNodes(b);var a=b.resultData||this.resultData;var c=this;jQuery.each(a,function(e,d){c.createResult(jQuery.extend(b,{result:d,index:e}))})},loadContainer:function(a){var a=a||{};var c=a.containerTemplatePath||this.containerTemplatePath;var b=this;site.endeca.generic.template.get({path:c,object:a.resultData||b.resultData,rb:rb?rb.endeca:null,callback:function(d){d=jQuery.trim(d);if(d){b.node=jQuery(d);if(a.parentNode&&b.node){a.parentNode.append(b.node)}}}})},createResult:function(b){var b=b||{};this.setResultClass(b);var a=new this.resultClass({parent:this,templatePath:b.templatePath||this.templatePath,resultData:b.result,parentNode:b.contentNode||this.contentNode,configuration:b.configuration||this.configuration,mixins:b.mixins||this.mixins});this.resultNodes.push(a)},setResultClass:function(b){var b=b||{};var c=b.baseClass||this.baseClass||site.endeca.result;if(!this.resultClass){b.childClass=b.childClass||this.childClass||"";var a=b.mixins||this.mixins[this.resultMixinKey]||this.mixins["result."+b.childClass]||this.mixins.result||{};this.resultClass=b.childClass&&c[b.childClass]?site.endeca.generic.Class.create(site.endeca.generic.Class.mixin(c,a),c[b.childClass]):site.endeca.generic.Class.mixin(c,a)}},displayResultNodes:function(){for(var a=0;a<this.resultNodes.length;a++){this.resultNodes[a].displayResult()}if(this.resultNodes.length){if(this.resultNodes[0].node){this.resultNodes[0].node.addClass("first")}if(this.resultNodes[this.resultNodes.length-1].node){this.resultNodes[this.resultNodes.length-1].node.addClass("last")}}},hide:function(){this.parentNode.hide()},show:function(){this.parentNode.show()},reset:function(){if(this.containerTemplatePath){if(this.node){this.node.remove()}}else{if(this.contentNode){this.contentNode.empty()}else{if(this.node){this.node.empty()}}}this.resultData=[];this.resultNodes=[]}});site.endeca.results=generic.endeca.results;generic.endeca.resultsgroup=site.endeca.generic.Class.create(site.endeca.results,{initialize:function(a){this.baseClass=site.endeca.results;this._super(a)},displayResults:function(a){var a=a||{};var b=this;if(b.parentNode&&b.parentNode.length>1){b.parentNode.each(function(){a.parentNode=jQuery(this);b._super(a)})}else{b._super(a)}},createResult:function(b){var b=b||{};b.childClass=this.resultsChildClass||b.childClass;b.mixins=b.mixins||this.mixins[this.resultsMixinKey]||this.mixins["results."+b.childClass]||this.mixins.results;this.setResultClass(b);var a=new this.resultClass(jQuery.extend({parent:this,resultData:b.result,parentNode:this.contentNode||this.node||this.parentNode,summaryResultData:this.summaryResultData,mixins:this.mixins,configuration:b.configuration||this.configuration},b.resultsArgs||this.resultsArgs||{}));this.resultNodes.push(a)},reset:function(){for(var a=0;a<this.resultNodes.length;a++){this.resultNodes[a].reset()}this._super()}});site.endeca.resultsgroup=generic.endeca.resultsgroup;generic.endeca.mixins.accordion={initialize:function(a){this._super(a);this.accordionHeaderNode=[];this.accordionContentNode=[];this.accordionCloseNode=[]},displayResults:function(a){this._super(a);this.setupAccordion()},setupAccordion:function(){this.accordionHeaderNode=this.node.find(".accordion-header:first");this.accordionContentNode=this.node.find(".accordion-content:first");this.accordionCloseNode=this.node.find(".accordion-close:first");if(this.accordionHeaderNode.length&&this.accordionContentNode.length){var a=this;this.accordionHeaderNode.unbind("click");this.accordionHeaderNode.bind("click",{that:a},a.onClick);if(this.accordionCloseNode.length){this.accordionCloseNode.unbind("click");this.accordionCloseNode.bind("click",{that:a},a.closeAccordion)}}},onClick:function(b){b.preventDefault();var a=b.data.that;a.toggleAccordion();return false},accordionIsOpen:function(){return !this.accordionHeaderNode.hasClass("collapsed")},accordionIsClosed:function(){return this.accordionHeaderNode.hasClass("collapsed")},toggleAccordion:function(){if(!this.accordionHeaderNode.hasClass("collapsed")){this.closeAccordion()}else{this.openAccordion()}},openAccordion:function(b){var a=b&&b.data&&b.data.that?b.data.that:this;if(this.accordionHeaderNode.length&&this.accordionContentNode.length&&this.accordionIsClosed()){this.accordionHeaderNode.removeClass("collapsed");this.accordionContentNode.addClass("opened");this.accordionContentNode.show();this.accordionContentNode.trigger("accordion:open",a)}},closeAccordion:function(b){var a=b&&b.data&&b.data.that?b.data.that:this;if(a.accordionHeaderNode.length&&a.accordionContentNode.length&&a.accordionIsOpen()){a.accordionHeaderNode.addClass("collapsed");a.accordionContentNode.removeClass("opened");a.accordionContentNode.hide();a.accordionContentNode.trigger("accordion:closed",a)}}};site.endeca.mixins.accordion=generic.endeca.mixins.accordion;generic.endeca.mixins.links={displayResultCallback:function(b){var b=b||{};b.resultData=b.resultData||this.resultData;var e=b.node||b.parentNode||this.node||this.parentNode;e=e.find(".link-mixin").length?e.find(".link-mixin"):e.find("a").length?e.find("a"):e;var d=b["Selection Link"]||b.resultData["Selection Link"]||b.resultData["Removal Link"]||e.attr("rel");if(d&&e){var c=this;e.bind("click",{that:c,link:d},c.onClick);e.bind("simulate:click",{that:c,link:d},c.onClick);if(e.href){var f=site.endeca.generic.env.parsedQuery();f.qs=encodeURIComponent(d);var a=document.location.pathname+"?"+jQuery.param(f);e.href=a}}}};site.endeca.mixins.links=generic.endeca.mixins.links;generic.endeca.mixins.links.address=jQuery.extend({onClick:function(b){var a=b.data.that;jQuery.address.value("?"+b.data.link);if(a.configuration.scrollTo&&a.configuration.scrollTo.length){jQuery(window).scrollTop(a.configuration.scrollTo.position().top)}else{if(!(a.noScroll||a.configuration.noScroll)){scroll(0,0)}}b.preventDefault();return false}},site.endeca.mixins.links);site.endeca.mixins.links.address=generic.endeca.mixins.links.address;generic.endeca.mixins.summary={initialize:function(a){this._super(a);this.summaryResultData={totalRecords:this.resultData.length};this.summaryResultData.resultText=this.summaryResultData.totalRecords==1?site.endeca.generic.rb("endeca").get("result"):site.endeca.generic.rb("endeca").get("results")},setupNodes:function(a){var a=a||{};this._super(a);if(this.node){this.summaryNode=this.node.find(".results-summary").length?this.node.find(".results-summary"):null}},displayResults:function(a){this._super(a);this.setupSummary()},setupSummary:function(){if(this.summaryNode&&this.configuration.summaryTemplatePath&&this.summaryResultData){this.summary=new site.endeca.result({parentNode:this.summaryNode,templatePath:this.configuration.summaryTemplatePath,resultData:this.summaryResultData});this.summary.displayResult()}},reset:function(a){this._super(a);if(this.summaryNode){this.summaryNode.empty()}}};site.endeca.mixins.summary=generic.endeca.mixins.summary;generic.endeca.result.contentDrupal={displayResult:function(c){var c=c||{};var b=c.resultData||this.resultData;var a=c.parentNode||this.parentNode;if(b.drupal_node_id){jQuery.ajax({url:"/"+Drupal.settings.pathPrefix+"elc_api/endeca_content_result/"+b.drupal_node_id,context:this,complete:function(d){var e=d.responseText;e=jQuery.trim(e);if(e){this.node=jQuery(e);if(a&&this.node){a.append(this.node)}this.displayResultCallback(d)}}})}}};site.endeca.result.contentDrupal=generic.endeca.result.contentDrupal;generic.endeca.result.product={initialize:function(a){this.shadeResults=null;this._super(a)},displayResult:function(a){this.setupReviewData();this.setupBrandData();this._super(a)},displayResultCallback:function(a){this.setupQuickShop();this.setupAddToBag(this.resultData.skus[0]);if(this.resultData.shaded){this.setupShades()}if(this.resultData.sized){this.setupSizeSelect()}if(typeof this.displayResultCallbackBrand=="function"){this.displayResultCallbackBrand()}},setupReviewData:function(){this.resultData.ratingDisplay=this.resultData.TOTAL_REVIEW_COUNT?"block":"none";this.resultData.ratingReviewWord=this.resultData.TOTAL_REVIEW_COUNT&&this.resultData.TOTAL_REVIEW_COUNT>1?site.endeca.generic.rb("language").get("reviews"):site.endeca.generic.rb("language").get("review");this.resultData.ratingRounded=this.resultData.TOTAL_REVIEW_COUNT?Math.round(this.resultData.AVERAGE_RATING*10)/10:0},setupBrandData:function(){this.resultData.formattedPriceRange=this.formatPriceRange();this.resultData.price2=this.resultData.skus[0].formattedPrice2;this.resultData.shadedClass=this.resultData.shaded?"shaded":"nonshaded";this.resultData.sizedClass=this.resultData.sized?"sized":"notsized";this.resultData.isComingSoon=eval(jQuery.map(this.resultData.skus,function(sku){return sku.isComingSoon}).join("+"))>0?"coming_soon":"";if(this.resultData.DESCRIPTION){this.resultData.descriptionBlurb=this.resultData.DESCRIPTION.substring(0,(this.configuration.descriptionBlurb||120));this.resultData.descriptionRest=this.resultData.DESCRIPTION.substring((this.configuration.descriptionBlurb||120));this.resultData.descriptionFull=this.resultData.descriptionBlurb+this.resultData.descriptionRest}this.resultData.skinTypeText=typeof productPage!="undefined"&&typeof productPage.getAllSkinTypes=="function"?productPage.getAllSkinTypes(this.resultData):"";if(typeof this.resultData.ATTRIBUTE_BENEFIT!="undefined"){this.resultData.attrBenefit=this.resultData.ATTRIBUTE_BENEFIT.toString().replace(/,/g,", ")}},formatPriceRange:function(){var b=this.resultData.skus[0];var d=this.resultData.skus[0];for(var a=0;a<this.resultData.skus.length;a++){var c=this.resultData.skus[a];b=(c.PRICE<b.PRICE)?c:b;d=(c.PRICE>d.PRICE)?c:d}return(b!==d)?b.formattedPrice+" - "+d.formattedPrice:this.resultData.skus[0].formattedPrice},setupQuickShop:function(){var b=this.node.find("a.quickshop-link");if(b&&typeof brx!="undefined"){var a=this;b.bind("click",function(f){f.preventDefault();if(jQuery.isFunction(productPage.launchQuickshop)){var d=jQuery(this).attr("id").replace("quickview-link-","");productPage.launchQuickshop(d)}else{var c=brx.productView.quickshop({productData:a.resultData})}});b.bind("mouseover",function(c){jQuery(this).find(".quickshop-btn").addClass("qs-active");jQuery(this).closest(".result").addClass("qs")});b.bind("mouseout",function(c){jQuery(this).find(".quickshop-btn").removeClass("qs-active");jQuery(this).closest(".result").removeClass("qs")})}},setupAddToBag:function(d){var b=typeof d==="number"?d:d.SKU_BASE_ID;var c=this.node.find("a.btn-add-to-bag");var a=this.node.find("span.add-progress");c.unbind();c.attr("data-skubaseid",b);c.bind("click",function(f){f.preventDefault();if(a.length){c.hide();a.show();$(document).one("addToCart.success addToCart.failure",function(){a.hide();c.show()})}site.addToCart({skuBaseId:$(this).attr("data-skubaseid")})})},setupNote:function(){},setupGiftSetComponents:function(){},setupShades:function(){var c=this.node.find(".shades");var e=this.node.find(".selected-shade-name");var f=this.node.find(".shade-price");if(c.length){var b;if(typeof this.configuration.maxmimumShades!="undefined"&&this.resultData.skus.length>this.configuration.maxmimumShades){b=this.resultData.skus.slice(0,this.configuration.maxmimumShades)}else{b=this.resultData.skus.slice(0)}c.addClass("shades_"+this.resultData.skus.length);for(var a=0;a<b.length;a++){b[a].PRODUCT_ID=this.resultData.PRODUCT_ID;b[a].url=this.resultData.url}this.shadeResults=new site.endeca.results({resultData:b,parentNode:c,childClass:"shade",configuration:this.configuration,mixins:this.mixins});this.shadeResults.displayResults();this.shadeResults.show();var d=this;this.node.bind("select.sku",function(g,h){d.setupAddToBag(h.resultData.SKU_BASE_ID);if(e.length){e.text(h.resultData.SHADENAME)}if(f.length){f.text(h.resultData.formattedPrice)}});this.shadeResults.resultNodes[0].selectShade()}},setupSizeSelect:function(){var a=this.node.find(".size-select");var c=this.node.find(".size-price");if(a.length){this.sizeResults=new site.endeca.results({resultData:this.resultData.skus,parentNode:a,childClass:"size",configuration:this.configuration,mixins:this.mixins});this.sizeResults.displayResults();this.sizeResults.show();var b=this;this.node.bind("select.sku",function(d,e){b.setupAddToBag(e.resultData.SKU_BASE_ID);if(c.length){c.text(e.resultData.formattedPrice)}})}}};site.endeca.result.product=generic.endeca.result.product;generic.endeca.result.shade={initialize:function(a){this._super(a);this.templatePath=this.configuration.shadeTemplatePath||"/templates/endeca/products/shade.tmpl";this.displayResult()},displayResultCallback:function(a){this.drawSwatch();if(!this.configuration.suppressShadeEvents){this.initListeners()}},drawSwatch:function(a){if(!this.resultData.HEX_VALUE_STRING||this.resultData.HEX_VALUE_STRING.length<1){return}var e=this.node.find(".search-swatch-container");var c=this.resultData.HEX_VALUE_STRING.split(",");for(var b=0;b<c.length;b++){var f=jQuery("<div/>");f.css({"background-color":c[b]});if(b==0){f.addClass("first")}if(b==c.length-1){f.addClass("last")}if(c.length==1){f.addClass("single")}e.append(f)}e.css("width","auto")},initListeners:function(a){var b=this;this.node.bind("click",b,function(d){var c=d.data;c.selectShade()})},selectShade:function(a){this.node.siblings(".shade").removeClass("active");this.node.addClass("active");this.node.trigger("select.sku",this)}};site.endeca.result.shade=generic.endeca.result.shade;site.endeca.result.size={initialize:function(a){this._super(a);this.templatePath="/templates/endeca/products/size.tmpl";this.displayResult()},displayResultCallback:function(a){this.initListeners()},initListeners:function(a){var b=this;this.node.bind("click",b,function(d){var c=d.data;this.node.trigger("select.sku",c)})}};generic.endeca.result.summary={displayResult:function(d){var d=d||{};var f=jQuery.extend({results:"/templates/endeca/summary/results.tmpl",noResults:"/templates/endeca/summary/no-results.tmpl",noTerm:"/templates/endeca/summary/no-term.tmpl",autoCorrect:"/templates/endeca/summary/auto-correct.tmpl",didYouMean:"/templates/endeca/summary/did-you-mean.tmpl"},(this.configuration.templatePaths||{}));if(this.resultData.searchTerm==""){this.templatePath=f.noTerm}else{if(this.hasResults){this.templatePath=f.results;this.resultData.productAnchorLinkDisplay=this.resultData.totalProductRecords>0?"inline":"none";this.resultData.contentAnchorLinkDisplay=this.resultData.totalContentRecords>0?"inline":"none";this.resultData.productResultText+=this.resultData.totalContentRecords>0?",":""}else{this.templatePath=f.noResults}}this._super(d);var g=this.node.find(".searchTerms");if(this.resultData.breadcrumbs&&g.length){var a=[];for(var e=0;e<this.resultData.breadcrumbs.length;e++){for(var c=0;c<this.resultData.breadcrumbs[e]["Dimension Values"].length;c++){a.push(', "'+this.resultData.breadcrumbs[e]["Dimension Values"][c]["Dim Value Name"]+'"')}}g.append(a.join(""))}var h=this.node.find("#auto-correct");if(this.resultData.correctedTerms&&this.resultData.correctedTerms.length&&h.length){this.templatePath=f.autoCorrect;d.resultData=this.resultData;d.resultData.correctedTerm=this.resultData.correctedTerms.join(",");d.parentNode=h;this._super(d)}var b=this.node.find("#did-you-mean");if(this.resultData.didYouMean&&this.resultData.didYouMean.length&&b.length){this.templatePath=f.didYouMean;d.resultData=this.resultData.didYouMean[0];d.parentNode=b;this._super(d)}},reset:function(){this.parentNode.empty()}};site.endeca.result.summary=generic.endeca.result.summary;generic.endeca.results.breadcrumbs={initialize:function(a){this.childClass="breadcrumb";this._super(a);if((typeof this.resultData.length=="undefined"&&this.resultData)||this.resultData.length){this.displayResults()}},displayResults:function(){this.resultData["Dimension Name RB Key"]=this.resultData["Dimension Name"].replace(/\W+/gi,"_").toLowerCase();this.resultData["Dimension Name RB"]=site.endeca.generic.rb("endeca").get("dimension_"+this.resultData["Dimension Name RB Key"]);this.resultData["Dimension Description RB"]=site.endeca.generic.rb("endeca").get("dimension_"+this.resultData["Dimension Name RB Key"]+".description");var b=this;var a=jQuery.map(this.resultData["Dimension Values"],function(c){return jQuery.extend(c,{"Dimension Name":b.resultData["Dimension Name"],"Dimension Name RB Key":b.resultData["Dimension Name RB Key"],"Dimension Name RB":b.resultData["Dimension Name RB"],"Dimension Description RB":b.resultData["Dimension Description RB"]})});this._super({resultData:this.resultData["Dimension Values"]});this.displayResultNodes()},createResult:function(a){a.templatePath=this.childTemplatePath||this.templatePath||"/templates/endeca/breadcrumbs/link.tmpl";if(this.configuration.breadcrumbTemplates&&this.configuration.breadcrumbTemplates[this.resultData["Dimension Name RB Key"]]){a.templatePath=this.configuration.breadcrumbTemplates[this.resultData["Dimension Name RB Key"]]}a.result["Dim Value Name RB Key"]=a.result["Dim Value Name"].replace(/\W+/gi,"_").toLowerCase();a.result["Dim Value Name RB"]=site.endeca.generic.rb("endeca").get("refinement_"+a.result["Dim Value Name RB Key"]);this._super(a)}};site.endeca.results.breadcrumbs=generic.endeca.results.breadcrumbs;generic.endeca.results.bestsellers={initialize:function(a){this.childClass="product";this._super(a)},displayResults:function(){var a=this;this.query=new site.endeca.query(jQuery.extend({callbackCompleted:function(){var b=new site.endeca.catalog.product({jsonResult:a.query.jsonResult});a.resultData=b.getProducts();a._super();a.displayResultNodes();if(typeof a.configuration.queryCallback=="function"){a.configuration.queryCallback()}}},site.endeca.configuration.query,this.configuration.queryArgs||{}));this.query.prepare();this.query.execute()},createResult:function(a){a.result.context="bestseller-product";a.templatePath=this.childTemplatePath||this.templatePath||"/templates/endeca/products/bestseller-result.tmpl";this._super(a)}};site.endeca.results.bestsellers=generic.endeca.results.bestsellers;generic.endeca.results.contentzone=site.endeca.generic.Class.create(site.endeca.results,{displayResults:function(a){var a=a||{};this.zoneName=this.resultData[0].Properties.Zone;this.styleName=this.resultData[0].Properties.Style;this.styleConfig=this.configuration.styles&&this.configuration.styles[this.styleName]?this.configuration.styles[this.styleName]:undefined;a.containerTemplatePath=this.configuration.containerTemplatePath;if(typeof this.configuration.containerTemplatePath=="object"){a.containerTemplatePath=this.configuration.containerTemplatePath[this.styleName]}else{if(this.styleConfig&&this.styleConfig.containerTemplatePath){a.containerTemplatePath=this.styleConfig.containerTemplatePath}}this._super(a)},createResult:function(a){var a=a||{};var b=(a.result.Properties&&a.result.Properties.Style)?a.result.Properties.Style:this.styleName;a.templatePath=this.configuration.templatePath;if(typeof this.configuration.templatePath=="object"){a.templatePath=this.configuration.templatePath[b]}else{if(this.styleConfig&&this.styleConfig.templatePath){a.templatePath=this.styleConfig.templatePath}}this._super(a)}});site.endeca.results.contentzone=generic.endeca.results.contentzone;generic.endeca.results.contentzone.content={initialize:function(a){this._super(a);if(this.resultData.length){this.displayResults()}},displayResults:function(a){this._super(a);this.displayResultNodes()},createResult:function(a){a.result=a.result.Properties;if(a.result.Style.match(/drupal/i)){a.childClass="contentDrupal"}this._super(a)}};site.endeca.results.contentzone.content=generic.endeca.results.contentzone.content;generic.endeca.results.contentzone.products={initialize:function(b){this.childClass="product";this._super(b);this.query=null;this.totalProductResults=0;var d=[];for(var c=0;c<this.resultData.length;c++){for(var a=0;a<this.resultData[c]["Records"].length;a++){d.push(this.resultData[c]["Records"][a]["Record Spec"]);this.totalProductResults++}}this.query=new site.endeca.query(jQuery.extend({callbackCompleted:site.endeca.helpers.func.bind(this.searchCompleted,this),searchMode:"matchany",searchTerm:d.join(" "),searchKey:"rec_id"},site.endeca.configuration.query,this.configuration.queryArgs||{}));this.query.prepare();this.query.execute()},searchCompleted:function(){var a=new site.endeca.catalog.product({jsonResult:this.query.jsonResult});this.displayResults({resultData:a.getProducts()});this.displayResultNodes()},createResult:function(a){a.result.context="featured-product";a.result.callout=site.endeca.generic.rb("endeca").get("callout.featured-product");this._super(a)}};site.endeca.results.contentzone.products=generic.endeca.results.contentzone.products;generic.endeca.results.pagination={initialize:function(a){this._super(a);this.displayResults()},displayResults:function(){if(this.resultData){this.setupNodes();if(this.resultData.viewAllLink&&this.configuration.viewAllLink){this.createResult({templatePath:this.configuration.viewAllPageTemplatePath||"/templates/endeca/pagination/viewall.tmpl",result:{"Selection Link":this.resultData.viewAllLink}})}if(this.resultData.previousPageLink&&this.configuration.previousPageLink){this.createResult({templatePath:this.configuration.previousPageTemplatePath||"/templates/endeca/pagination/previous.tmpl",result:{"Selection Link":this.resultData.previousPageLink}})}var a=this.contentNode;if(this.configuration.containerTemplatePath){this.containerTemplatePath=this.configuration.containerTemplatePath;this.setupNodes()}if(this.resultData.directPageLinks){for(var b=0;b<this.resultData.directPageLinks.length;b++){this.createResult({templatePath:this.resultData.numberOfCurrentPage==b+1?this.configuration.currentTemplatePath||"/templates/endeca/pagination/current.tmpl":this.configuration.linkTemplatePath||"/templates/endeca/pagination/link.tmpl",result:{"Selection Link":this.resultData.directPageLinks[b],Content:b+1}})}}this.contentNode=a;if(this.resultData.nextPageLink&&this.configuration.nextPageLink){this.createResult({templatePath:this.configuration.nextPageTemplatePath||"/templates/endeca/pagination/next.tmpl",result:{"Selection Link":this.resultData.nextPageLink}})}this.displayResultNodes()}},setupSummary:function(){return;if(this.paginationSummaryNode){if(this.summaryResultData&&this.summaryResultData.totalProductRecords>1){var a="endeca.templates.pagination.summary.shown";if(this.resultData&&this.resultData.numberOfCurrentPage==1){a="endeca.templates.pagination.summary.topShown"}this.createResult({templatePath:a,result:this.summaryResultData,contentNode:this.paginationSummaryNode})}if(this.resultData&&this.resultData.nextPageLink){this.createResult({templatePath:"endeca.templates.pagination.summary.next",result:{"Selection Link":this.resultData.nextPageLink},contentNode:this.paginationSummaryNode})}if(this.summaryResultData){var c=null;var d=null;if(this.summaryResultData.startingRecord==1&&this.summaryResultData.endingRecord>10){c="endeca.templates.pagination.summary.viewLess";d={}}else{if(this.summaryResultData.totalProductRecords>10){c="endeca.templates.pagination.summary.viewAll";d={recordsPerPage:10000}}}if(c){var b=new site.endeca.base.query(d);this.createResult({templatePath:c,result:{"Selection Link":b.toQueryString()},contentNode:this.paginationSummaryNode})}}}}};site.endeca.results.pagination=generic.endeca.results.pagination;generic.endeca.results.products={initialize:function(a){this.childClass="product";this._super(a)},displayResults:function(a){var a=a||{};this._super(a);this.displayResultNodes()},createResult:function(a){a.templatePath=this.childTemplatePath||"/templates/endeca/products/result.tmpl";a.result.context="product";this._super(a)}};site.endeca.results.products=generic.endeca.results.products;generic.endeca.results.recentsearches={initialize:function(a){this.searchTerm=null;this._super(a)},displayResults:function(a){this.setupRecentSearches();this._super({templatePath:"/templates/endeca/recent-search.tmpl"});this.displayResultNodes()},setupRecentSearches:function(){var b=encodeURIComponent(this.searchTerm);var d=jQuery.cookie("researches");var a=d?String(d).split(":::"):[];if(this.searchTerm){a.unshift(b)}a=site.endeca.helpers.array.unique(a).splice(0,this.configuration.maximumRecentSearches);if(a&&a.length){jQuery.cookie("researches",a.join(":::"));for(var c=0;c<a.length;c++){this.resultData.push({searchTerm:decodeURIComponent(a[c]).replace(/\+/," "),"Selection Link":"Ntt="+a[c],"Display Link":"?search="+a[c]})}}}};site.endeca.results.recentsearches=generic.endeca.results.recentsearches;generic.endeca.results.refinements={initialize:function(a){this.containerTemplatePath="/templates/endeca/refinements/container.tmpl";this.childClass="refinement";this.moreRefinement=null;this.refinementIDs={};this._super(a);this.resultData["Dimension Name RB Key"]=this.resultData["Dimension Name"].replace(/\W+/gi,"_").toLowerCase();this.resultData["Dimension Name RB"]=site.endeca.generic.rb("endeca").get("dimension_"+this.resultData["Dimension Name RB Key"]);this.resultData["Dimension Description RB"]=site.endeca.generic.rb("endeca").get("dimension_"+this.resultData["Dimension Name RB Key"]+"_description");if(this.configuration.refinementContainerTemplates&&this.configuration.refinementContainerTemplates[this.resultData["Dimension Name RB Key"]]){this.containerTemplatePath=this.configuration.refinementContainerTemplates[this.resultData["Dimension Name RB Key"]]}this.displayResults({resultData:this.resultData["Dimension Values"]});this.displayResultNodes()},createResult:function(a){a.templatePath=this.childTemplatePath||this.templatePath||"/templates/endeca/refinements/link.tmpl";if(this.configuration.refinementTemplates&&this.configuration.refinementTemplates[this.resultData["Dimension Name RB Key"]]){a.templatePath=this.configuration.refinementTemplates[this.resultData["Dimension Name RB Key"]]}if(this.configuration.resultMixinKeys&&this.configuration.resultMixinKeys[this.resultData["Dimension Name RB Key"]]){a.mixins=this.mixins[this.configuration.resultMixinKeys[this.resultData["Dimension Name RB Key"]]]}if(this.resultData["Dim Value Properties"]&&this.resultData["Dim Value Properties"]["DGraph.More"]&&a.result["Dim Value Name"]=="More..."){a.templatePath="/templates/endeca/refinements/show-all.tmpl";this.moreRefinement=a.result["Dim Value ID"]}else{this.refinementIDs[a.result["Dim Value ID"]]=1;a.result["Dim Value Name RB Key"]=a.result["Dim Value Name"].replace(/\W+/gi,"_").toLowerCase();a.result["Dim Value Name RB"]=site.endeca.generic.rb("endeca").get("refinement_"+a.result["Dim Value Name RB Key"]);a.result["Dim Value Description RB"]=site.endeca.generic.rb("endeca").get("refinement_description_"+a.result["Dim Value Name RB Key"])}this._super(a)},reset:function(a){this.refinementIDs={};this._super(a)}};site.endeca.results.refinements=generic.endeca.results.refinements;generic.endeca.resultsgroup.breadcrumbs={displayResults:function(a){var a=a||{};a.childClass="breadcrumbs";this._super(a);var b=this;jQuery(".clear-all").each(function(c,d){var e=jQuery(this);if(b.displayResultCallback){b.displayResultCallback({"Selection Link":" ",node:e});e.show()}else{e.hide()}})}};site.endeca.resultsgroup.breadcrumbs=generic.endeca.resultsgroup.breadcrumbs;generic.endeca.resultsgroup.contentzones={initialize:function(a){this.resultData={};this.zones={};this.crawlData=[];this.hasSoloResults=false;this.totalResults=0;this.contentzones={};this._super(a)},setCrawlData:function(a){var a=a||{};if(a.crawlData&&a.crawlData.length){this.resultData.crawlData={style:"content",records:a.crawlData}}},setupNodes:function(a){var a=a||{};this.node=this.parentNode||a.node},displayResults:function(b){var b=b||{};b.baseClass=site.endeca.results.contentzone;for(var a in this.contentzones){this.resultClass=null;var d=b;var c=this.resultData[a];if(c&&c.records&&c.records.length){d.resultData=[this.resultData[a].records];d.childClass=this.contentzones[a].childClass||(site.endeca.results.contentzone[this.resultData[a].style]?this.resultData[a].style:this.resultData[a].style.match(/product/i)?"products":"content");d.node=this.contentzones[a].node;if(this.contentzones[a].solo){this.hasSoloResults=true}if(this.contentzones[a].counted){this.totalResults+=d.resultData[0].length}d.configuration=this.contentzones[a];d.mixins=this.mixins["results.contentzone"];this._super(d);this.contentzones[a].resultNode=this.resultNodes[this.resultNodes.length-1];d.node.show()}else{this.contentzones[a].node.hide()}}},hide:function(){for(var a=0;a<this.resultNodes.length;a++){this.resultNodes[a].hide()}},show:function(){for(var a=0;a<this.resultNodes.length;a++){this.resultNodes[a].show()}},reset:function(){for(var a=0;a<this.resultNodes.length;a++){this.resultNodes[a].reset()}this.resultNodes=[];this.totalResults=0}};site.endeca.resultsgroup.contentzones=generic.endeca.resultsgroup.contentzones;generic.endeca.resultsgroup.pagination={displayResults:function(a){var a=a||{};a.childClass="pagination";var b=this;jQuery(".pagination").each(function(){b.parentNode=jQuery(this);a.resultData=[b.resultData];b._super(a)})}};site.endeca.resultsgroup.pagination=generic.endeca.resultsgroup.pagination;generic.endeca.resultsgroup.refinements={initialize:function(a){this.moreRefinements=[];this._super(a)},displayResults:function(a){var a=a||{};a.childClass="refinements";this._super(a);var b=this;jQuery(".expand-all").each(function(d,c){if(b.moreRefinements.length){if(b.displayResultCallback){b.displayResultCallback({"Selection Link":"Ne="+b.moreRefinements().join("+"),node:d})}d.show()}else{d.hide()}})},moreRefinements:function(){if(this.moreRefinements.length){return this.moreRefinements}else{for(var a=0;a<this.resultNodes.length;a++){if(this.resultNodes[a].moreRefinement){this.moreRefinements.push(this.resultNodes[a].moreRefinement)}}}},reset:function(a){this.moreRefinements=[];this._super(a)}};site.endeca.resultsgroup.refinements=generic.endeca.resultsgroup.refinements;site.endeca.configuration={query:{MDEXHost:"localhost",MDEXPort:{ko_KR:16100},logHost:site.endeca.generic.env.domain.match(/www/)?"njlndca01":"localhost",logPort:{ko_KR:16104},defaultDimensionIds:[8127,8061],configuredRangeFilters:{skuShoppable:"s_shoppable|GT+0",skuPromotional:"s_promotional|GT+0",skuSearchable:"s_searchable|GT+0",productTrFlag:"p_TR_FLAG|LT+1",productDisplayable:"p_displayable|GT+0",productShoppable:"p_shoppable|GT+0",inventoryStatus:"s_INVENTORY_STATUS|GT+0|s_INVENTORY_STATUS|LT+3"},defaultRangeFilters:["inventoryStatus"],configuredRecordFilters:{products:"rec_type:product",content:"rec_type:content",locale:"locale:"+jQuery.cookie("LOCALE"),activeSkus:"NOT(s_INVENTORY_STATUS:5)",discontinued:"NOT(s_discontinued:1)"}},coremetricsEnabled:false,omnitureEnabled:true,contentzones:{},mixins:{}};var site=site||{};site.endeca=site.endeca||{};site.endeca.instances=site.endeca.instances||{};site.endeca.instances.typeahead=site.endeca.instances.typeahead||{};site.endeca.instances.typeahead.control=site.endeca.generic.Class.create(site.endeca.control,{initialize:function(a){this._super(a);if(this.nodes.wrapper.length&&this.nodes.inputElement.length){var b=this;this.nodes.inputElement.bind("keyup",b,b.onKeyUp);this._watchToClose()}},onKeyUp:function(c){var b=c.data;var a=jQuery.trim(b.nodes.inputElement[0].value);if(a!=b.searchTerm&&a.length>=b.configuration.minSearchLength){b.searchTerm=a;c.data.search({searchTerm:a})}},_watchToClose:function(){var a=this;jQuery(document).bind("click",a,function(c){var d=c.target;var b=c.data;b.nodes.closeLinks.each(function(){if(this==d){b.nodes.wrapper.hide();return false}});if(!jQuery(d).parents(b.nodes.wrapper.selector).length&&d!=b.nodes.inputElement[0]&&d!=b.nodes.wrapper[0]){b.nodes.wrapper.hide();return}})},searchCompleted:function(){if(!this._super()){return}this.results.products.resultData=this.catalogs.product.resultList;if(this.results.products.resultData.length){this.results.products.displayResults();this.results.products.show();this.hasResults=true}else{this.results.products.hide()}var a=this.nodes.wrapper.find("a.see-all-results");a.attr("href",this.configuration.fullSearchBaseUrl+encodeURIComponent(this.queries.product.searchTerm));this.results.summary_text.resultData={totalRecords:this.catalogs.product.resultList.length,resultText:this.meta.searchInfo.productResultText};this.results.summary_text.hasResults=this.hasResults;this.results.summary_text.displayResult();this.nodes.wrapper.show();if(this.hasResults){if(this.nodes.noResults){this.nodes.noResults.hide()}else{this.nodes.wrapper.show()}a.show();this.results.summary_text.show()}else{if(this.nodes.noResults){this.nodes.noResults.show()}else{this.nodes.wrapper.hide()}a.hide();this.results.summary_text.hide()}this.hideLoading()},showLoading:function(){this._super();if(this.results.summary_text){this.results.summary_text.hide()}if(this.nodes.noResults){this.nodes.noResults.hide()}}});var site=site||{};site.endeca=site.endeca||{};site.endeca.instances=site.endeca.instances||{};site.endeca.instances.typeahead=site.endeca.instances.typeahead||{};jQuery(document).ready(function(){site.endeca.instances.typeahead.configuration=jQuery.extend(true,{},site.endeca.configuration,{followRedirects:false,minSearchLength:2,fullSearchBaseUrl:"/products/search/esearch.tmpl?search=",nodes:{wrapper:$("#typeahead-wrapper"),inputElement:$("#edit-keywords"),loading:$(".loading","#typeahead-wrapper"),closeLinks:$(".close-link","#typeahead-wrapper"),noResults:$(".no-results","#typeahead-wrapper")},mixins:{"results.products":site.endeca.mixins.summary,"results.contentzone":site.endeca.mixins.summary},queries:{product:{rangeFilters:["inventoryStatus"],recordFilters:["products"],recordsPerPage:2,defaultDimensionIds:[]}},results:{summary_text:{baseClass:"site.endeca.result",instanceArgs:{parentNode:jQuery(".typeahead-summary","#global-typeahead-search-box"),templatePath:"/templates/endeca/typeahead/summary.tmpl"}},products:{baseClass:"site.endeca.results",childClass:"site.endeca.results.products",instanceArgs:{parentNode:$(".product-results","#typeahead-wrapper"),childTemplatePath:"/templates/endeca/typeahead/product-result.tmpl"},configuration:{summaryTemplatePath:"/templates/endeca/typeahead/product-summary.tmpl"}}}});new site.endeca.instances.typeahead.control(site.endeca.instances.typeahead.configuration)});